<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æœˆå…‰ä¸‹çš„é™°å½± - FLOWER OF MEMORY</title>
    <style>
        :root {
            --bg-color: #f7f1e3; /* ç¾Šçš®ç´™è‰² */
            --text-color: #2c2c2c;
            --accent-color: #8e44ad; /* æœˆå…‰ç´« */
            --sidebar-bg: #eae0c8;
            --sidebar-text: #4a4a4a;
            --font-main: "Noto Serif TC", "Songti TC", "PMingLiU", serif;
            --font-ui: "Noto Sans TC", "Microsoft JhengHei", sans-serif;
        }

        [data-theme="dark"] {
            --bg-color: #1a1a1a;
            --text-color: #d1d1d1;
            --accent-color: #a29bfe;
            --sidebar-bg: #2d2d2d;
            --sidebar-text: #a0a0a0;
        }

        * { box-sizing: border-box; transition: background-color 0.3s, color 0.3s; }

        body {
            margin: 0;
            padding: 0;
            background-color: var(--bg-color);
            color: var(--text-color);
            font-family: var(--font-main);
            line-height: 1.8;
            font-size: 18px; /* é»˜èªå­—é«” */
            overflow-x: hidden;
        }

        /* ä½ˆå±€å®¹å™¨ */
        .container {
            display: flex;
            min-height: 100vh;
        }

        /* å´é‚Šæ¬„ (ç›®éŒ„) */
        .sidebar {
            width: 250px;
            background-color: var(--sidebar-bg);
            padding: 20px;
            position: fixed;
            height: 100%;
            overflow-y: auto;
            border-right: 1px solid rgba(0,0,0,0.1);
            z-index: 200; /* æé«˜å±¤ç´š */
            transition: transform 0.3s ease; /* æ·»åŠ æ»‘å‹•å‹•ç•« */
        }

        .sidebar h2 {
            font-family: var(--font-ui);
            font-size: 1.2rem;
            color: var(--accent-color);
            margin-top: 0;
            border-bottom: 2px solid var(--accent-color);
            padding-bottom: 10px;
        }

        .toc-list {
            list-style: none;
            padding: 0;
        }

        .toc-list li {
            margin-bottom: 8px;
        }

        .toc-list a {
            text-decoration: none;
            color: var(--sidebar-text);
            font-family: var(--font-ui);
            font-size: 0.95rem;
            display: block;
            padding: 5px 10px;
            border-radius: 4px;
        }

        .toc-list a:hover, .toc-list a.active {
            background-color: rgba(0,0,0,0.05);
            color: var(--accent-color);
            font-weight: bold;
        }

        /* ä¸»å…§å®¹å€ */
        .main-content {
            flex: 1;
            margin-left: 250px; /* ç•™å‡ºå´é‚Šæ¬„å¯¬åº¦ */
            padding: 40px 60px;
            max-width: 900px; /* é™åˆ¶é–±è®€å¯¬åº¦ */
        }

        /* æ§åˆ¶åˆ— (å›ºå®šåœ¨å³ä¸Š) */
        .controls {
            position: fixed;
            top: 20px;
            right: 30px;
            display: flex;
            gap: 10px;
            background: rgba(255,255,255,0.8);
            padding: 8px;
            border-radius: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            backdrop-filter: blur(5px);
            z-index: 101;
        }
        
        [data-theme="dark"] .controls {
            background: rgba(0,0,0,0.6);
        }

        .btn {
            border: none;
            background: none;
            cursor: pointer;
            font-size: 1.2rem;
            padding: 5px 10px;
            border-radius: 50%;
            color: var(--text-color);
        }

        .btn:hover {
            background-color: rgba(0,0,0,0.1);
            color: var(--accent-color);
        }

        /* æ¼¢å ¡é¸å–®æŒ‰éˆ• (æ‰‹æ©Ÿç‰ˆé¡¯ç¤º) */
        .menu-toggle {
            display: none; /* é›»è…¦ç‰ˆéš±è— */
            position: fixed;
            top: 20px;
            left: 20px;
            z-index: 201; /* æ¯”å´é‚Šæ¬„æ›´é«˜ï¼Œç¢ºä¿å¯é»æ“Š */
            background: rgba(255,255,255,0.8);
            border: none;
            font-size: 1.5rem;
            padding: 8px 12px;
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            color: var(--text-color);
            backdrop-filter: blur(5px);
        }

        [data-theme="dark"] .menu-toggle {
            background: rgba(0,0,0,0.6);
        }

        /* é®ç½©å±¤ (æ‰‹æ©Ÿç‰ˆå´é‚Šæ¬„æ‰“é–‹æ™‚é¡¯ç¤º) */
        .overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 199; /* åœ¨å´é‚Šæ¬„ä¹‹ä¸‹ï¼Œå…§å®¹ä¹‹ä¸Š */
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .overlay.active {
            display: block;
            opacity: 1;
        }

        /* æ–‡ç« æ¨£å¼ */
        h1.book-title {
            text-align: center;
            font-size: 2.5rem;
            margin-bottom: 10px;
            color: var(--accent-color);
        }

        .author {
            text-align: center;
            font-style: italic;
            margin-bottom: 50px;
            opacity: 0.8;
        }

        .chapter {
            margin-bottom: 60px;
            padding-top: 40px;
            border-bottom: 1px solid rgba(0,0,0,0.05);
        }

        .chapter-title {
            font-size: 1.8rem;
            font-weight: bold;
            margin-bottom: 30px;
            color: var(--accent-color);
            font-family: var(--font-ui);
        }

        p {
            margin-bottom: 1.5em;
            text-align: justify;
        }

        /* å°è©±å¼·èª¿ */
        p:has(strong) {
            color: var(--accent-color);
        }

        /* éŸ¿æ‡‰å¼è¨­è¨ˆ */
        @media (max-width: 768px) {
            .container { flex-direction: column; }
            
            /* æ‰‹æ©Ÿç‰ˆå´é‚Šæ¬„æ¨£å¼ */
            .sidebar {
                transform: translateX(-100%); /* é è¨­éš±è—åˆ°å·¦å´è¢å¹•å¤– */
                width: 280px; /* æ‰‹æ©Ÿç‰ˆç¨å¾®å¯¬ä¸€é»æ–¹ä¾¿é»æ“Š */
                box-shadow: 2px 0 10px rgba(0,0,0,0.2);
            }

            .sidebar.active {
                transform: translateX(0); /* æ»‘å…¥é¡¯ç¤º */
            }

            /* æ¢å¾©å‚ç›´åˆ—è¡¨æ¨£å¼ (è¦†è“‹ä¹‹å‰çš„æ©«å‘æ¨£å¼) */
            .toc-list {
                display: block;
                overflow-x: visible;
                padding-bottom: 0;
            }
            .toc-list li { 
                text-align: left; 
            }

            .main-content { 
                margin-left: 0; 
                padding: 20px; 
                padding-top: 80px; /* ç•™å‡ºé ‚éƒ¨æŒ‰éˆ•ç©ºé–“ */
            }
            
            .controls { top: 20px; right: 20px; }
            .menu-toggle { display: block; } /* é¡¯ç¤ºæ¼¢å ¡æŒ‰éˆ• */
            
            .chapter-title { font-size: 1.5rem; }
            body { font-size: 16px; }
        }
    </style>
</head>
<body>

    <!-- æ¼¢å ¡é¸å–®æŒ‰éˆ• -->
    <button class="menu-toggle" id="menuToggle" title="ç›®éŒ„">â˜°</button>
    
    <!-- é®ç½©å±¤ -->
    <div class="overlay" id="overlay"></div>

    <div class="controls">
        <button class="btn" id="decreaseFont" title="ç¸®å°å­—é«”">A-</button>
        <button class="btn" id="increaseFont" title="æ”¾å¤§å­—é«”">A+</button>
        <button class="btn" id="themeToggle" title="åˆ‡æ›å¤œé–“æ¨¡å¼">ğŸŒ™</button>
    </div>

    <div class="container">
        <nav class="sidebar" id="sidebar">
            <h2>ç›®éŒ„</h2>
            <ul class="toc-list" id="toc">
                <!-- JSç”Ÿæˆç›®éŒ„ -->
            </ul>
        </nav>

        <main class="main-content" id="content-area">
            <h1 class="book-title">æœˆå…‰ä¸‹çš„é™°å½±</h1>
            <div class="author">ä½œè€…ï¼šFLOWER OF MEMORY</div>
            
            <!-- å°èªªå…§å®¹é–‹å§‹ -->
            <div id="novel-content">
                <!-- å…§å®¹å°‡ç”± JS æ³¨å…¥ï¼Œä¸¦é€²è¡Œç¹ç°¡è½‰æ›è™•ç† -->
            </div>
        </main>
    </div>

    <script>
        // åŸå§‹æ–‡æœ¬ (åŒ…å«å…¨éƒ¨å…§å®¹)
        const rawText = `
æ›´å¤šå°èªªæ›´æ–° åŠ‡æ›´ æ­¡è¿åŠ å…¥æŠ–éŸ³ç¾¤505191734855ï¼Œç¾¤å…¬å‘Šè‡ªå–
å¼•è¨€
- æ›¸ç±ï¼šã€Šæœˆå…‰ä¸‹çš„é™°å½±ã€‹
- ä½œè€…ï¼šFLOWER OF MEMORY
ã€Œä½ ç‚ºä»€éº¼â€¦â€¦æŠŠæœˆäº®ç´‹åœ¨å·¦èƒ¸ä¸Šï¼Ÿã€	
ã€Œ......ã€
è¢«å•çš„äººä¸¦æœªé–‹å£ä½œç­”ã€‚ç›¸åï¼Œå¥¹å˜´è§’æµ®ç¾å‡ºä¸€çµ²æ·¡æ·¡çš„å¾®ç¬‘ï¼ŒéŠ³åˆ©çš„é›™çœ¸é–ƒçˆè‘—éš±ç§˜çš„å«ç¾©ï¼Œå›æœ›è‘—å°æ–¹ã€‚
ç„¶è€Œï¼Œé€™ä¸€åˆ‡éƒ½ç™¼ç”Ÿåœ¨å¹¾å€‹å°æ™‚ä¹‹å‰â€¦â€¦
æ°´æµå¾æ·‹æµ´å™´é ­å‚¾ç€‰è€Œä¸‹ï¼Œé †è‘—é–‰ç›®è€Œç«‹ä¹‹äººçš„ç™½çš™è‚Œè†šæµæ·Œã€‚å¥¹å°‡æ²æµ´éœ²æ“ åœ¨çº–ç´°çš„æŒå¿ƒï¼Œç„¶å¾Œå°å¿ƒç¿¼ç¿¼åœ°å¡—æŠ¹åœ¨èµ¤è£¸çš„èº«é«”ä¸Šï¼Œå‹•ä½œç´°ç·»å…¥å¾®ã€‚é‚£è‚¡æ…£å¸¸èƒ½å¸¶ä¾†æ”¾é¬†çš„æº«æŸ”é¦™æ°£ï¼Œæ­¤åˆ»å»æœªèƒ½å¦‚å¾€å¸¸èˆ¬æœ‰æ•ˆèˆ’ç·©å¥¹çš„æƒ…ç·’ã€‚é›™è…¿ä»å› ç–²æ†Šè€Œé¡«æŠ–ï¼Œæ•æ„Ÿéƒ¨ä½å› å‰ä¸€æ™šçš„éåº¦ä½¿ç”¨è€Œæ„Ÿåˆ°åˆºç—›ï¼Œè®“å¥¹å½·å½¿å‰›å¾å¤¢ä¸­é†’ä¾†ã€‚ç„¶è€Œï¼Œé€™ä¸€åˆ‡éƒ½æ˜¯ç¾éº—çš„ç¾å¯¦ï¼Œæ¯”ä»»ä½•å¤¢å¢ƒéƒ½è¦çµ¢çˆ›ã€‚
é‚£å€‹ä»¤äººé›£å¿˜çš„å»ï¼Œå¦‚åŒå®Œç¾çš„ç«èŠ±ï¼Œé»ç‡ƒäº†æ¿€æƒ…çš„ç«ç„°ã€‚è¢«å¯µæ„›çš„å¹¸ç¦â€¦â€¦æº«æš–è€Œé…¥éº»çš„è§¸æ„Ÿå‚³éå…¨èº«â€¦â€¦å¾å½¼æ­¤å”‡é–“æº¢å‡ºçš„å–˜æ¯è²â€¦â€¦å‰ä¸€æ™šä»–å€‘æ¿€çƒˆç³¾çºæ™‚çš„æ²ˆé‡å‘¼å¸å’Œå¦‚é›¨èˆ¬å‚¾ç€‰çš„æ±—æ°´â€”â€”é€™æ˜¯ä¸€æ®µè‡³ä»Šä»åˆ»éª¨éŠ˜å¿ƒçš„æ„›æƒ…ã€‚
åœ¨å¥¹çš„ä¸€ç”Ÿä¸­ï¼Œå¥¹å¾æœªæƒ³è±¡éé€™æ¨£çš„é—œä¿‚æœƒç™¼ç”Ÿåœ¨è‡ªå·±èº«ä¸Šã€‚å¦‚æœèªªé‚£åªæ˜¯è½‰ç¬å³é€çš„æƒ…æ„Ÿï¼Œé‚£å°±å¤§éŒ¯ç‰¹éŒ¯äº†â€¦â€¦å› ç‚ºé‚£å€‹åœ¨èˆå°ä¸Šå½ˆè‘—å‰ä»–ã€èº«æé«˜æŒ‘ä¿®é•·çš„å¥³äººçš„ç¾éº—è‡‰é¾â€¦â€¦é‚£é›™èˆ‡å¥¹å°è¦–çš„éŠ³åˆ©è€Œç¾éº—çš„çœ¼ç›ï¼Œé‚£æ¿ƒå¯†å½æ›²çš„çœ‰æ¯›ï¼Œé«˜æŒºçš„é¼»æ¢ï¼Œä»¥åŠéš¨è‘—æ—‹å¾‹è¼•è¼•å”±å’Œçš„å®Œç¾å”‡å½¢â€¦â€¦é€™ä¸€åˆ‡éƒ½æ•£é«®è‘—è®“å¥¹ç„¡æ³•æŠ—æ‹’çš„é­…åŠ›ã€‚
æ»²å…¥è¡€æ¶²çš„é…’ç²¾ä¸¦æœªå½±éŸ¿å¥¹çš„æ¸…é†’ã€‚é€™ä½æ­Œæ‰‹å…¼éŸ³æ¨‚å®¶çš„é­…åŠ›ï¼Œä¸¦ä¸è¶³ä»¥è¼•æ˜“å‹•æ–å¥¹çš„å¿ƒã€‚ç„¶è€Œï¼Œæ­£æ˜¯å› ç‚ºå…§å¿ƒæ·±è™•éš±è—çš„æŸç¨®æƒ…æ„Ÿï¼Œæ‰è®“é€™æ®µé—œä¿‚è®Šå¾—æ·±åˆ»èµ·ä¾†ã€‚ä»–å€‘ä¸æ˜¯æˆ€äººï¼Œå»åœ¨æ¯ä¸€å€‹æƒ…æ„Ÿç¬é–“éƒ½å¾—åˆ°äº†æ»¿è¶³ï¼Œæ¯ä¸€çµ²æ„Ÿå—ä¸­éƒ½ç¸ˆç¹è‘—æº«æŸ”çš„æ°£æ¯ã€‚æ¯ä¸€æ¬¡è§¸ç¢°éƒ½æº«æš–å¾—ä»¤äººé™¶é†‰ï¼Œå¹¾ä¹è®“å¥¹é›£ä»¥æ‰¿å—ï¼Œç„¶è€Œï¼Œå¥¹å»æ„Ÿåˆ°â€¦â€¦ä¸¦ä¸æ»¿è¶³ã€‚
æ³¨ï¼š
é€™æœ¬æ›¸è¬›è¿°çš„æ˜¯Sasapin ã€ŒJanã€â€¦â€¦ä¾†è‡ªã€ŠMY ONLY SUNSHINEã€‹ä¸€æ›¸ä¸­Atitha ã€ŒSunã€çš„é›™èƒèƒå§å§â€¦â€¦
ä½†åœ¨é€™æœ¬æ›¸é‡Œï¼Œå¥¹å€‘æŠŠJançš„åå­—æ”¹æˆäº†Lunaã€‚

---------çµ‚ç« -------
æ›´å¤šå°èªªæ›´æ–° åŠ‡æ›´ æ­¡è¿åŠ å…¥æŠ–éŸ³ç¾¤505191734855ï¼Œç¾¤å…¬å‘Šè‡ªå–
`;

        // åˆå§‹åŒ–
        function init() {
            const contentDiv = document.getElementById('novel-content');
            const tocList = document.getElementById('toc');
            const menuToggle = document.getElementById('menuToggle');
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('overlay');
            const lines = rawText.split('\n');
            let currentChapterId = '';
            let tocHtml = '';
            let contentHtml = '';

            // è§£æä¸¦æ§‹å»ºå…§å®¹
            lines.forEach(line => {
                
                if (!line) return;

                if (line.match(/^(ç¬¬.+ç« |å¼•è¨€|æ³¨ï¼š|åºç« |ç•ªå¤–|---------ç»ˆç« -------)/)) {
                    // ç« ç¯€æ¨™é¡Œ
                    const title = line.replace(/^- /, '');
                    currentChapterId = 'chapter-' + Math.random().toString(36).substr(2, 9);
                    
                    contentHtml += `<div class="chapter" id="${currentChapterId}">
                        <div class="chapter-title">${title}</div>
                    </div>`;
                    
                    tocHtml += `<li><a href="#${currentChapterId}">${title}</a></li>`;
                } else if (line.match(/^- /)) {
                     // åˆ—è¡¨é …
                     contentHtml += `<p>â€¢ ${line.substring(2)}</p>`;
                } else {
                    // æ­£æ–‡æ®µè½
                    // è­˜åˆ¥å°è©±
                    let formattedLine = line.replace(/â€œ(.+?)â€/g, 'â€œ<strong>$1</strong>â€');
                    contentHtml += `<p>${formattedLine}</p>`;
                }
            });

            contentDiv.innerHTML = contentHtml;
            tocList.innerHTML = tocHtml;

            // é¸å–®æ§åˆ¶åŠŸèƒ½
            function toggleMenu() {
                sidebar.classList.toggle('active');
                overlay.classList.toggle('active');
            }

            function closeMenu() {
                sidebar.classList.remove('active');
                overlay.classList.remove('active');
            }

            menuToggle.addEventListener('click', toggleMenu);
            overlay.addEventListener('click', closeMenu);

            // é»æ“Šç›®éŒ„é€£çµå¾Œè‡ªå‹•é—œé–‰é¸å–®ï¼ˆæ‰‹æ©Ÿç‰ˆé«”é©—å„ªåŒ–ï¼‰
            const tocLinks = document.querySelectorAll('.toc-list a');
            tocLinks.forEach(link => {
                link.addEventListener('click', () => {
                    if (window.innerWidth <= 768) {
                        closeMenu();
                    }
                });
            });

            // æ¢å¾©é–±è®€é€²åº¦
            const savedScroll = localStorage.getItem('moonshadow_scroll');
            if (savedScroll) {
                window.scrollTo(0, parseInt(savedScroll));
            }

            // è¨­ç½®å­—é«”å¤§å°
            const savedFontSize = localStorage.getItem('moonshadow_fontsize');
            if (savedFontSize) {
                document.body.style.fontSize = savedFontSize + 'px';
            }
            
            // è¨­ç½®ä¸»é¡Œ
            const savedTheme = localStorage.getItem('moonshadow_theme');
            if (savedTheme === 'dark') {
                document.body.setAttribute('data-theme', 'dark');
            }

            // ç¶å®šæ»¾å‹•äº‹ä»¶
            window.addEventListener('scroll', () => {
                localStorage.setItem('moonshadow_scroll', window.scrollY);
                updateActiveToc();
            });
        }

        // æ›´æ–°ç›®éŒ„é«˜äº®
        function updateActiveToc() {
            const chapters = document.querySelectorAll('.chapter');
            let current = '';
            
            chapters.forEach(chapter => {
                const chapterTop = chapter.offsetTop;
                if (scrollY >= chapterTop - 100) {
                    current = chapter.getAttribute('id');
                }
            });

            document.querySelectorAll('.toc-list a').forEach(a => {
                a.classList.remove('active');
                if (a.getAttribute('href') === '#' + current) {
                    a.classList.add('active');
                    // è‡ªå‹•æ»¾å‹•ç›®éŒ„
                    const sidebar = document.querySelector('.sidebar');
                    const linkTop = a.offsetTop;
                    const sidebarHeight = sidebar.clientHeight;
                    if (linkTop > sidebar.scrollTop + sidebarHeight - 50 || linkTop < sidebar.scrollTop) {
                       // sidebar.scrollTo(0, linkTop - 50);
                    }
                }
            });
        }

        // äº¤äº’æŒ‰éˆ•
        document.getElementById('themeToggle').addEventListener('click', () => {
            if (document.body.getAttribute('data-theme') === 'dark') {
                document.body.removeAttribute('data-theme');
                localStorage.setItem('moonshadow_theme', 'light');
            } else {
                document.body.setAttribute('data-theme', 'dark');
                localStorage.setItem('moonshadow_theme', 'dark');
            }
        });

        document.getElementById('increaseFont').addEventListener('click', () => {
            let currentSize = parseInt(window.getComputedStyle(document.body).fontSize);
            if (currentSize < 24) {
                let newSize = currentSize + 1;
                document.body.style.fontSize = newSize + 'px';
                localStorage.setItem('moonshadow_fontsize', newSize);
            }
        });

        document.getElementById('decreaseFont').addEventListener('click', () => {
            let currentSize = parseInt(window.getComputedStyle(document.body).fontSize);
            if (currentSize > 14) {
                let newSize = currentSize - 1;
                document.body.style.fontSize = newSize + 'px';
                localStorage.setItem('moonshadow_fontsize', newSize);
            }
        });

        init();
    </script>
</body>
</html>